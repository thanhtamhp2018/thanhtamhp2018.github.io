!function(){var e=function(e){var t={exports:{}};return e.call(t.exports,t,t.exports),t.exports},t=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}(),r=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},i=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},o=function e(t,r,i){null===t&&(t=Function.prototype);var o=Object.getOwnPropertyDescriptor(t,r);if(o===undefined){var n=Object.getPrototypeOf(t);return null===n?undefined:e(n,r,i)}if("value"in o)return o.value;var s=o.get;return s===undefined?undefined:s.call(i)},n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},s=function(e){return e&&e.__esModule?e:{"default":e}},a=e(function(e,i){"use strict";Object.defineProperty(i,"__esModule",{value:!0});var o=function(){function e(t){var i=t.targetNode,o=t.iframeSrc;r(this,e),this.iframeSrc=o,this.targetNode=i}return t(e,[{key:"createIframe",value:function(e,t){this.iframe=document.createElement("iframe"),this.iframe.setAttribute("title",e),this.iframe.setAttribute("id",t),this.iframe.setAttribute("src",this.iframeSrc),this.iframe.setAttribute("sandbox","allow-same-origin allow-scripts allow-top-navigation"),this.iframe.setAttribute("style",this.loadingStyles),this.targetNode.appendChild(this.iframe),this.target=this.iframe.contentWindow}}],[{key:"convertStylesObjectToString",value:function(e){return Object.keys(e).map(function(t){return t+": "+e[t]+";"}).join(" ")}},{key:"returnObjectValues",value:function(e){return Object.keys(e).map(function(t){return e[t]})}}]),e}();i["default"]=o});e(function(e,l){"use strict";Object.defineProperty(l,"__esModule",{value:!0});var u=s(a),f=function(e){function s(e){var t=e.targetNode,i=e.iframeSrc,o=e.height,a=e.previewToken,l=e.themeStoreId;r(this,s);var u=n(this,(s.__proto__||Object.getPrototypeOf(s)).call(this,{targetNode:t,iframeSrc:i}));return u.POST_MESSAGE_EVENTS={OPEN_MODAL:"open_modal",CLOSE_MODAL:"close_modal",OPEN_POPOVER:"open_popover",CLOSE_POPOVER:"close_popover",HIDE_IFRAME:"hide_iframe",PURCHASE_THEME:"purchase_theme",CUSTOMIZE_THEME:"customize_theme",COPY_SHARE_LINK:"copy_share_link",TEMPLATE_EDITOR_REFRESH_PAGE:'{"key":"pageRefresh"}'},u.height=o||60,u.previewToken=a,u.themeStoreId=l,u.loadingStyles=s.convertStylesObjectToString({position:"fixed",transform:"translateY("+u.height+"px)",border:"none"}),u.defaultStyles=s.convertStylesObjectToString({position:"fixed",bottom:0,left:0,"z-index":99999,width:"100%",height:u.height+"px",border:"none","box-shadow":"0 -1px 3px rgba(0, 0, 0, 0.2)",overflow:"hidden",transform:"translateY(0)",transition:"transform 300ms"}),u.modalOpenStyles=s.convertStylesObjectToString({position:"fixed",bottom:0,left:0,"z-index":999999,width:"100%",height:"100vh",border:"none"}),u}return i(s,e),t(s,[{key:"init",value:function(){var e=this;o(s.prototype.__proto__||Object.getPrototypeOf(s.prototype),"createIframe",this).call(this,"Preview Bar","preview-bar-iframe"),this.iframe.contentWindow.addEventListener("DOMContentLoaded",function(){e.iframe.setAttribute("style",e.defaultStyles)}),window.addEventListener("message",this.postMessageBuffer.bind(this))}},{key:"postMessageBuffer",value:function(e){var t=e.data,r=e.origin;!t||s.returnObjectValues(this.POST_MESSAGE_EVENTS).indexOf(t)<0||this.iframeSrc.indexOf(r)<0||(t!==this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE&&this.postTrekkieData(t),this.postMessageHandler(t,r))}},{key:"postMessageHandler",value:function(e,t){switch(e){case this.POST_MESSAGE_EVENTS.OPEN_MODAL:this.iframe.setAttribute("style",this.modalOpenStyles),this.sendPostMessage("modal_opened",t);break;case this.POST_MESSAGE_EVENTS.CLOSE_MODAL:this.iframe.setAttribute("style",this.defaultStyles),this.sendPostMessage("modal_closed",t);break;case this.POST_MESSAGE_EVENTS.OPEN_POPOVER:this.iframe.setAttribute("style",this.modalOpenStyles),this.sendPostMessage("popover_opened",t);break;case this.POST_MESSAGE_EVENTS.CLOSE_POPOVER:this.iframe.setAttribute("style",this.defaultStyles),this.sendPostMessage("popover_closed",t);break;case this.POST_MESSAGE_EVENTS.HIDE_IFRAME:this.hideIframe();break;case this.POST_MESSAGE_EVENTS.CUSTOMIZE_THEME:this.sendPostMessage("redirected_to_customize_theme",t);break;case this.POST_MESSAGE_EVENTS.PURCHASE_THEME:this.sendPostMessage("redirected_to_purchase",t);break;case this.POST_MESSAGE_EVENTS.TEMPLATE_EDITOR_REFRESH_PAGE:window.location.reload()}}},{key:"sendPostMessage",value:function(e,t){this.target.postMessage(e,t)}},{key:"hideIframe",value:function(){this.iframe.setAttribute("style","display: none"),document.querySelector("html").style.paddingBottom="0"}},{key:"postTrekkieData",value:function(e){window.trekkie.track("theme_sharing",{action:e,token:this.previewToken,themeStoreId:this.themeStoreId})}}]),s}(u["default"]);l["default"]=f,Shopify.PreviewBarInjector=null!=l["default"]?l["default"]:l})}("undefined"!=typeof global?global:"undefined"!=typeof window&&window);